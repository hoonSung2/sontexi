webpackJsonp([1],{LmuN:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),a=s("kxiW"),n=s.n(a),o=s("yviF"),r=s.n(o),l=(s("dih4"),s("881v"),{props:{driver:{type:Object,required:!0}},data:()=>({user:null,map:null,marker:null,taxi:null,user:null,infoWindow:null}),mounted(){r.a.auth().onAuthStateChanged(t=>{this.user=t}),this.initMap(),this.listenForLocationUpdates()},methods:{initMap(){this.map=new google.maps.Map(this.$refs.map,{zoom:16.2,mapTypeId:google.maps.MapTypeId.ROADMAP}),this.taxi=new google.maps.MarkerImage("https://cdn-icons-png.flaticon.com/512/2557/2557954.png",null,null,null,new google.maps.Size(50,50)),this.user=new google.maps.MarkerImage("https://cdn-icons-png.flaticon.com/512/1912/1912207.png",null,null,null,new google.maps.Size(45,45)),this.marker=new google.maps.Marker({map:this.map,position:new google.maps.LatLng(this.driver.lat,this.driver.lng),icon:this.taxi}),this.marker2=new google.maps.Marker({map:this.map,position:new google.maps.LatLng(this.driver.lat,this.driver.lng),position:new google.maps.LatLng(36.32567092441993,127.338683962429),icon:this.user}),this.infoWindow=new google.maps.InfoWindow({content:`<div class="ui header">${this.driver.email}</div>`,disableAutoPan:!0}),this.marker.addListener("click",()=>{this.infoWindow.open(this.map,this.marker)}),this.map.setCenter(new google.maps.LatLng(this.driver.lat,this.driver.lng))},listenForLocationUpdates(){r.a.firestore().collection("location").doc(this.driver.id).onSnapshot(t=>{if(t.exists){const e=t.data();this.driver.lat=e.lat,this.driver.lng=e.lng,this.updateMap()}})},closeModal(){this.$emit("close")},signOutButtonPressed(){r.a.auth().signOut().then(()=>{this.$router.push({name:"Signin"})}).catch(t=>{console.log(t.message)})},updateMap(){this.marker.setPosition(new google.maps.LatLng(this.driver.lat,this.driver.lng)),this.map.setCenter(new google.maps.LatLng(this.driver.lat,this.driver.lng))}}}),c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"backdrop",staticStyle:{"z-index":"9999"}},[s("div",{staticClass:"modal",staticStyle:{width:"1300px",height:"900px","z-index":"1550"},on:{click:function(e){return t.closeModal()}}},[s("div",{ref:"map",staticClass:"map",staticStyle:{width:"100%",height:"100%","z-index":"1549"},attrs:{id:"map"}})])])},staticRenderFns:[]};var d={name:"side",components:{Admin:s("VU/8")(l,c,!1,function(t){s("LmuN")},"data-v-4cdcf934",null).exports},data:()=>({showModal:!1,selectedDriver:null,user:null,drivers:[],carnums:[]}),mounted(){this.listenForLocationUpdates()},methods:{toggleModal(t){this.selectedDriver=t===this.selectedDriver?null:t,this.showModal=!this.showModal},async listenForLocationUpdates(){await n.a.firestore().collection("location").where("active","==",!0).onSnapshot(t=>{const e=t.docs.map(t=>{const e=t.data();return e.id=t.id,e});if(this.selectedDriver){const t=e.find(t=>t.id===this.selectedDriver.id);t&&(this.selectedDriver=t)}this.drivers=e})}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"side"},t._l(t.drivers,function(e,i){return s("div",{key:i},[s("div",{staticClass:"column"},[s("button",{staticClass:"email",staticStyle:{"margin-bottom":"15px"},on:{click:function(s){return t.toggleModal(e)}}},[t._v("\n        "+t._s(e.CarNumber)+"\n        "),t.showModal&&t.selectedDriver===e?s("admin",{attrs:{driver:e},on:{close:t.toggleModal}}):t._e()],1)])])}),0)},staticRenderFns:[]};var u={name:"App",components:{side:s("VU/8")(d,p,!1,function(t){s("lCju")},null,null).exports},data:()=>({user:null}),async mounted(){n.a.auth().onAuthStateChanged(t=>{this.user=t})},methods:{makeCall(){n.a.firestore().collection("location").where("status","==","").get().then(t=>{t.forEach(t=>{t.ref.update({status:"requested"}).then(()=>{console.log("기존 문서의 status 필드를 requested로 업데이트했습니다.")}).catch(t=>{console.error("문서 업데이트 에러: ",t)})})}).catch(t=>{console.error("문서 조회 에러: ",t)})}}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ex-layout",attrs:{id:"app"}},[this._m(0),this._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"lnb"},[e("side")],1),this._v(" "),e("div",{staticClass:"content"},[e("button",{staticClass:"call ",on:{click:this.makeCall}},[this._v("택시 호출")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"top"},[e("p",{staticClass:"stx"},[e("span",{staticClass:"letter"},[this._v("S")]),this._v(" "),e("span",{staticClass:"letter"},[this._v("T")]),this._v(" "),e("span",{staticClass:"letter"},[this._v("X")])])])}]};var m=s("VU/8")(u,h,!1,function(t){s("Y82u")},null,null).exports,g=s("/ocq");i.default.use(g.a);var v=new g.a({routes:[]}),f=s("TX8X"),w=s.n(f);s("hZls");i.default.use(w.a),i.default.config.productionTip=!1;r.a.initializeApp({apiKey:"AIzaSyBJ6_djq8S_DWQaJtBtWwefaqp05LKgDWg",authDomain:"taxi-6c99c.firebaseapp.com",databaseURL:"https://taxi-6c99c-default-rtdb.firebaseio.com",projectId:"taxi-6c99c",storageBucket:"taxi-6c99c.appspot.com",messagingSenderId:"990303890516",appId:"1:990303890516:web:d107aeb27e3be47d74d1c1",measurementId:"G-1MHMXS5V68"});r.a.firestore();new i.default({el:"#app",router:v,components:{App:m},template:"<App/>"})},Y82u:function(t,e){},lCju:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.893fa30178b925d5ebc1.js.map